---
date: '2007-02-28T13:46:00.000-08:00'
description: ''
published: true
slug: 2007-02-scratch-programming
tags:
- http://schemas.google.com/blogger/2008/kind#post
- General
- legacy-blogger
time_to_read: 5
title: Scratch Programming
---

*This was originally posted on blogger [here](https://techshorts.blogspot.com/2007/02/scratch-programming.html)*.

I have started doing more scratch programming, one off little bits of code that I use and throw away.  I found that I am not coding as much at work as I need to be, or want to  be for that matter.  I am loosing my touch.<br /><br />Like any thing else, if you don't use it you loose it.<br /><br />When I create projects I like to follow a specific file structure.  Nothing fancy, I use a solution folder with folders for lib, src and tests.  So when I create my scratch solutions I want to create the same folder structure, but there is no easy way to do it with Visual Studio.  I tried to create a project template, which would work if what I wanted was skeleton projects.  But what I want are skeleton folders and the VS templates won't create those.<br /><br />What I wound up doing was create an MSI using NSIS that would create the folder structure and copy core libraries that I like to use.  So far it is working out pretty good and was surprisingly simple to create, not by hand of course but with HM NIS Edit, a free tool to create and edit NSIS scripts.<br /><pre>; Script generated by the HM NIS Edit Script Wizard.<br /><br />; HM NIS Edit Wizard helper defines<br />!define PRODUCT_NAME "Scratch Template"<br />!define PRODUCT_VERSION "1.0"<br />!define PRODUCT_PUBLISHER "HomeNet"<br />!define PRODUCT_WEB_SITE "http://blog.ddpruitt.net"<br />;!define PRODUCT_DIR_REGKEY "SoftwareMicrosoftWindowsCurrentVersionApp PathsMbUnit.Cons.exe"<br /><br />; MUI 1.67 compatible ------<br />!include "MUI.nsh"<br /><br />; MUI Settings<br />!define MUI_ABORTWARNING<br />!define MUI_ICON "${NSISDIR}\Contrib\Graphics\Icons\modern-install.ico"<br /><br />; Welcome page<br />!insertmacro MUI_PAGE_WELCOME<br />; License page<br />;!insertmacro MUI_PAGE_LICENSE "............\path\to\licence\Your\SoftwareLicence.txt"<br />; Components page<br />!insertmacro MUI_PAGE_COMPONENTS<br />; Directory page<br />!insertmacro MUI_PAGE_DIRECTORY<br />; Instfiles page<br />!insertmacro MUI_PAGE_INSTFILES<br />; Finish page<br />!insertmacro MUI_PAGE_FINISH<br /><br />; Language files<br />!insertmacro MUI_LANGUAGE "English"<br /><br />; MUI end ------<br /><br />Name "${PRODUCT_NAME} ${PRODUCT_VERSION}"<br />OutFile "ScratchSetup.exe"<br />InstallDir "$DOCUMENTSVisual Studio 2005ProjectsScratchNewSolution"<br />;InstallDirRegKey HKLM "${PRODUCT_DIR_REGKEY}" ""<br />ShowInstDetails show<br /><br />Section "MainSection" SEC01<br />SetOutPath "$INSTDIR"<br />SetOverwrite ifnewer<br />File "GenericSolution.sln"<br />CreateDirectory $INSTDIRlib<br />CreateDirectory $INSTDIRsrc<br />CreateDirectory $INSTDIRtest<br />SectionEnd<br /><br />Section "MbUnit" SEC02<br />SetOutPath "$INSTDIR\lib\MbUnit"<br />SetOverwrite try<br />File "\lib\MbUnit\MbUnit.Framework.dll"<br />.<br />.<br />.<br />SectionEnd<br /><br />Section "Log4Net" SEC03<br />SetOutPath "$INSTDIR\lib\log4net"<br />File "\lib\log4net\log4net.dll"<br />SectionEnd<br /><br />Section "Enterprise Library (June 2006)" SEC04<br />SetOutPath "$INSTDIR\lib\EntLib.2006.01"<br />File "\lib\EnterpriseLibrary.2006.01\EntLibConfig.exe"<br />.<br />.<br />.<br />SectionEnd<br /><br />;Section -Post<br />;  WriteRegStr HKLM "${PRODUCT_DIR_REGKEY}" "" "$INSTDIR\lib\MbUnit\MbUnit.Cons.exe"<br />;SectionEnd<br /><br />; Section descriptions<br />!insertmacro MUI_FUNCTION_DESCRIPTION_BEGIN<br />!insertmacro MUI_DESCRIPTION_TEXT ${SEC01} ""<br />!insertmacro MUI_DESCRIPTION_TEXT ${SEC02} ""<br />!insertmacro MUI_DESCRIPTION_TEXT ${SEC03} ""<br />!insertmacro MUI_DESCRIPTION_TEXT ${SEC04} ""<br />!insertmacro MUI_FUNCTION_DESCRIPTION_END</pre><br />Add the appropriate files to the Sections, compile and your ready.